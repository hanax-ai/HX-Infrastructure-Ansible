# HX Infrastructure Ansible Configuration
# Following official Ansible best practices: https://docs.ansible.com/ansible/latest/reference_appendices/config.html

[defaults]
# =============================================================================
# INVENTORY CONFIGURATION
# =============================================================================
# Default inventory points to production, override with -i for other environments
# Reference: https://docs.ansible.com/ansible/latest/user_guide/intro_inventory.html
inventory = inventory/environments/production
host_key_checking = False
remote_user = ubuntu
private_key_file = ~/.ssh/id_rsa

# =============================================================================
# CONNECTION SETTINGS
# =============================================================================
# Connection timeout and parallelism settings
# Reference: https://docs.ansible.com/ansible/latest/user_guide/connection_details.html
timeout = 30
forks = 20
transport = smart

# =============================================================================
# FACT GATHERING AND CACHING
# =============================================================================
# Smart gathering and caching for performance
# Reference: https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html#caching-facts
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts_cache
fact_caching_timeout = 86400
gather_subset = all
gather_timeout = 10

# =============================================================================
# PERFORMANCE OPTIMIZATIONS
# =============================================================================
# SSH pipelining for better performance
# Reference: https://docs.ansible.com/ansible/latest/reference_appendices/config.html#ansible-pipelining
pipelining = True

# Control persistence for SSH connections
# Reference: https://docs.ansible.com/ansible/latest/user_guide/connection_details.html#ssh-connection
ssh_args = -o ControlMaster=auto -o ControlPersist=60s

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Centralized logging (ensure directory exists and is writable)
# Reference: https://docs.ansible.com/ansible/latest/reference_appendices/logging.html
log_path = ./ansible.log
display_skipped_hosts = False
display_ok_hosts = True
display_args_to_stdout = False

# =============================================================================
# OUTPUT AND CALLBACK CONFIGURATION
# =============================================================================
# Enhanced output formatting
# Reference: https://docs.ansible.com/ansible/latest/plugins/callback.html
stdout_callback = yaml
callback_whitelist = profile_tasks, timer, yaml
bin_ansible_callbacks = True

# =============================================================================
# ROLE AND COLLECTION PATHS
# =============================================================================
# Standard paths following Ansible conventions
# Reference: https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html#role-search-path
roles_path = roles:~/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles
collections_paths = ~/.ansible/collections:/usr/share/ansible/collections

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================
# Vault configuration for secrets management
# Reference: https://docs.ansible.com/ansible/latest/user_guide/vault.html
vault_password_file = ~/.ansible_vault_pass
vault_identity_list = default@~/.ansible_vault_pass

# Host key checking disabled for dynamic environments
# In production, consider enabling with proper key management
# (Note: host_key_checking already set in defaults section above)

# =============================================================================
# TASK EXECUTION SETTINGS
# =============================================================================
# Task execution behavior
# Reference: https://docs.ansible.com/ansible/latest/reference_appendices/config.html
hash_behaviour = replace
jinja2_extensions = jinja2.ext.do,jinja2.ext.i18n
allow_world_readable_tmpfiles = False
command_warnings = True
deprecation_warnings = True
system_warnings = True

# Error handling
any_errors_fatal = False
force_valid_group_names = ignore

# =============================================================================
# MODULE CONFIGURATION
# =============================================================================
# Module execution settings
# Reference: https://docs.ansible.com/ansible/latest/dev_guide/developing_modules_general.html
module_lang = C
module_set_locale = False

# =============================================================================
# INVENTORY PLUGIN CONFIGURATION
# =============================================================================
[inventory]
# Enable inventory plugins
# Reference: https://docs.ansible.com/ansible/latest/plugins/inventory.html
enable_plugins = host_list, script, auto, yaml, ini, toml, constructed

# Cache inventory for performance
cache = True
cache_plugin = jsonfile
cache_timeout = 3600
cache_connection = /tmp/ansible_inventory_cache

# =============================================================================
# SSH CONNECTION CONFIGURATION
# =============================================================================
[ssh_connection]
# SSH connection optimization
# Reference: https://docs.ansible.com/ansible/latest/user_guide/connection_details.html#ssh-connection
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o UserKnownHostsFile=/dev/null -o IdentitiesOnly=yes
control_path_dir = /tmp/.ansible-cp
control_path = %(directory)s/%%h-%%p-%%r
pipelining = True
scp_if_ssh = True
sftp_batch_mode = False
usetty = True

# SSH timeout settings
connect_timeout = 30
connect_retry_timeout = 15

# =============================================================================
# PERSISTENT CONNECTION CONFIGURATION
# =============================================================================
[persistent_connection]
# Persistent connection settings for network devices
# Reference: https://docs.ansible.com/ansible/latest/network/user_guide/platform_index.html
connect_timeout = 30
command_timeout = 30

# =============================================================================
# PARAMIKO CONNECTION CONFIGURATION
# =============================================================================
[paramiko_connection]
# Paramiko-specific settings (fallback SSH implementation)
# Reference: https://docs.ansible.com/ansible/latest/user_guide/connection_details.html#paramiko-connection
record_host_keys = False
proxy_command = 

# =============================================================================
# SELINUX CONFIGURATION
# =============================================================================
[selinux]
# SELinux settings for systems with SELinux enabled
# Reference: https://docs.ansible.com/ansible/latest/user_guide/become.html#risks-of-becoming-an-unprivileged-user
special_context_filesystems = fuse,nfs,vboxsf,ramfs,9p,vfat

# =============================================================================
# COLOR CONFIGURATION
# =============================================================================
[colors]
# Terminal color configuration for better readability
# Reference: https://docs.ansible.com/ansible/latest/reference_appendices/config.html#envvar-ANSIBLE_FORCE_COLOR
highlight = white
verbose = blue
warn = bright purple
error = red
debug = dark gray
deprecate = purple
skip = cyan
unreachable = red
ok = green
changed = yellow
diff_add = green
diff_remove = red
diff_lines = cyan

# =============================================================================
# DIFF CONFIGURATION
# =============================================================================
[diff]
# Diff output configuration
# Reference: https://docs.ansible.com/ansible/latest/user_guide/playbooks_checkmode.html
always = False
context = 3

# =============================================================================
# GALAXY CONFIGURATION
# =============================================================================
[galaxy]
# Ansible Galaxy configuration
# Reference: https://docs.ansible.com/ansible/latest/galaxy/user_guide.html
server_list = automation_hub, galaxy
ignore_certs = False

[galaxy_server.automation_hub]
url = https://console.redhat.com/api/automation-hub/
auth_url = https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token

[galaxy_server.galaxy]
url = https://galaxy.ansible.com/
