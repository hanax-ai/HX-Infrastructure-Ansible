{
  "timestamp": "2025-09-18T07:17:13.133717",
  "summary": {
    "total_templates": 22,
    "valid_templates": 9,
    "invalid_templates": 13,
    "total_issues": 9,
    "average_security_score": 70.0,
    "average_performance_score": 82.22,
    "inheritance_depth": 0
  },
  "templates": {
    "roles/hx_ca_trust_standardized/templates/security_audit.j2": {
      "path": "roles/hx_ca_trust_standardized/templates/security_audit.j2",
      "size": 2641,
      "lines": 82,
      "hash": "d611d06b6e15e1f2",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 90,
      "complexity_score": 15.9,
      "issues": [
        "Syntax Error: No filter named 'ternary'.\n  File \"<introspection>\", line 16"
      ],
      "recommendations": [
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": [
        {
          "type": "repeated_calculations",
          "count": 1,
          "impact": "MEDIUM"
        }
      ]
    },
    "./roles/hx_ca_trust_standardized/templates/ca_monitor.sh.j2": {
      "path": "./roles/hx_ca_trust_standardized/templates/ca_monitor.sh.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "roles/hx_ca_trust_standardized/templates/health_report.j2": {
      "path": "roles/hx_ca_trust_standardized/templates/health_report.j2",
      "size": 3477,
      "lines": 101,
      "hash": "4f274339153267db",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 60,
      "complexity_score": 21.7,
      "issues": [
        "Syntax Error: No filter named 'ternary'.\n  File \"<introspection>\", line 13"
      ],
      "recommendations": [
        "Consider breaking down complex template into smaller components",
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": [
        {
          "type": "nested_loops",
          "count": 1,
          "impact": "HIGH"
        },
        {
          "type": "complex_conditionals",
          "count": 1,
          "impact": "MEDIUM"
        },
        {
          "type": "repeated_calculations",
          "count": 1,
          "impact": "MEDIUM"
        }
      ]
    },
    "roles/hx_domain_join_standardized/templates/security_audit.j2": {
      "path": "roles/hx_domain_join_standardized/templates/security_audit.j2",
      "size": 3320,
      "lines": 96,
      "hash": "fda3fd0a2ad7b8c7",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 90,
      "complexity_score": 15.8,
      "issues": [
        "Syntax Error: No filter named 'ternary'.\n  File \"<introspection>\", line 13"
      ],
      "recommendations": [
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": [
        {
          "type": "repeated_calculations",
          "count": 1,
          "impact": "MEDIUM"
        }
      ]
    },
    "roles/hx_domain_join_standardized/templates/krb5.conf.j2": {
      "path": "roles/hx_domain_join_standardized/templates/krb5.conf.j2",
      "size": 1522,
      "lines": 47,
      "hash": "58d33ebb78752d50",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 100,
      "complexity_score": 2.6,
      "issues": [
        "Syntax Error: No filter named 'ternary'.\n  File \"<introspection>\", line 9"
      ],
      "recommendations": [
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": []
    },
    "./roles/hx_domain_join_standardized/templates/sudoers_domain.j2": {
      "path": "./roles/hx_domain_join_standardized/templates/sudoers_domain.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "./roles/hx_domain_join_standardized/templates/resolv.conf.j2": {
      "path": "./roles/hx_domain_join_standardized/templates/resolv.conf.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "./roles/hx_domain_join_standardized/templates/realmd.conf.j2": {
      "path": "./roles/hx_domain_join_standardized/templates/realmd.conf.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "roles/hx_domain_join_standardized/templates/sssd.conf.j2": {
      "path": "roles/hx_domain_join_standardized/templates/sssd.conf.j2",
      "size": 2047,
      "lines": 67,
      "hash": "4d7a649395c88f1b",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 60,
      "complexity_score": 7.0,
      "issues": [
        "Syntax Error: No filter named 'ternary'.\n  File \"<introspection>\", line 37"
      ],
      "recommendations": [
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": [
        {
          "type": "nested_loops",
          "count": 1,
          "impact": "HIGH"
        },
        {
          "type": "complex_conditionals",
          "count": 1,
          "impact": "MEDIUM"
        },
        {
          "type": "repeated_calculations",
          "count": 1,
          "impact": "MEDIUM"
        }
      ]
    },
    "./roles/hx_domain_join_standardized/templates/health_report.j2": {
      "path": "./roles/hx_domain_join_standardized/templates/health_report.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "./roles/ssh_key_management/templates/rotate_ssh_keys.sh.j2": {
      "path": "./roles/ssh_key_management/templates/rotate_ssh_keys.sh.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "./roles/ssh_key_management/templates/ssh_config.j2": {
      "path": "./roles/ssh_key_management/templates/ssh_config.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "roles/ssh_key_management/templates/ssh_key_inventory.yml.j2": {
      "path": "roles/ssh_key_management/templates/ssh_key_inventory.yml.j2",
      "size": 1207,
      "lines": 36,
      "hash": "049dda46957d609f",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 90,
      "complexity_score": 2.4,
      "issues": [
        "Syntax Error: No filter named 'strftime'.\n  File \"<introspection>\", line 27"
      ],
      "recommendations": [
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": [
        {
          "type": "repeated_calculations",
          "count": 1,
          "impact": "MEDIUM"
        }
      ]
    },
    "./roles/operational_safety/templates/rollback_script.sh.j2": {
      "path": "./roles/operational_safety/templates/rollback_script.sh.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "roles/hx_pg_auth_standardized/templates/security_audit.j2": {
      "path": "roles/hx_pg_auth_standardized/templates/security_audit.j2",
      "size": 1051,
      "lines": 37,
      "hash": "c1ea49513c0e233d",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 90,
      "complexity_score": 3.9,
      "issues": [
        "Syntax Error: No filter named 'ternary'.\n  File \"<introspection>\", line 14"
      ],
      "recommendations": [
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": [
        {
          "type": "repeated_calculations",
          "count": 1,
          "impact": "MEDIUM"
        }
      ]
    },
    "./roles/hx_pg_auth_standardized/templates/pg_ident.conf.j2": {
      "path": "./roles/hx_pg_auth_standardized/templates/pg_ident.conf.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "./roles/hx_pg_auth_standardized/templates/postgresql.conf.j2": {
      "path": "./roles/hx_pg_auth_standardized/templates/postgresql.conf.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "./roles/hx_pg_auth_standardized/templates/backup_manifest.j2": {
      "path": "./roles/hx_pg_auth_standardized/templates/backup_manifest.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "roles/hx_pg_auth_standardized/templates/health_report.j2": {
      "path": "roles/hx_pg_auth_standardized/templates/health_report.j2",
      "size": 890,
      "lines": 25,
      "hash": "37135499ab4e5252",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 80,
      "complexity_score": 2.5,
      "issues": [
        "Syntax Error: No filter named 'ternary'.\n  File \"<introspection>\", line 13"
      ],
      "recommendations": [
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": [
        {
          "type": "complex_conditionals",
          "count": 1,
          "impact": "MEDIUM"
        },
        {
          "type": "repeated_calculations",
          "count": 1,
          "impact": "MEDIUM"
        }
      ]
    },
    "./roles/hx_pg_auth_standardized/templates/pg_hba.conf.j2": {
      "path": "./roles/hx_pg_auth_standardized/templates/pg_hba.conf.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "./templates/safety_test_report.j2": {
      "path": "./templates/safety_test_report.j2",
      "error": "Node.find_all() missing 1 required positional argument: 'node_type'",
      "syntax_valid": false,
      "security_score": 0,
      "performance_score": 0
    },
    "templates/phase3_validation_report.json.j2": {
      "path": "templates/phase3_validation_report.json.j2",
      "size": 3284,
      "lines": 65,
      "hash": "4ab79f141b866f92",
      "syntax_valid": false,
      "variables": [],
      "blocks": [],
      "macros": [],
      "includes": [],
      "extends": null,
      "security_score": 70,
      "performance_score": 80,
      "complexity_score": 9.1,
      "issues": [
        "Syntax Error: expected token 'end of print statement', got 'validation_environment'"
      ],
      "recommendations": [
        "Add template documentation using {# comments #}"
      ],
      "security_issues": [
        {
          "category": "missing_escaping",
          "description": "Template variables may not be properly escaped",
          "severity": "MEDIUM"
        }
      ],
      "performance_issues": [
        {
          "type": "complex_conditionals",
          "count": 1,
          "impact": "MEDIUM"
        },
        {
          "type": "repeated_calculations",
          "count": 1,
          "impact": "MEDIUM"
        }
      ]
    }
  },
  "security_issues": [],
  "performance_recommendations": [],
  "inheritance_analysis": {
    "inheritance_map": {},
    "base_templates": [],
    "child_templates": [],
    "orphaned_templates": [
      "./roles/hx_ca_trust_standardized/templates/security_audit.j2",
      "./roles/hx_ca_trust_standardized/templates/ca_monitor.sh.j2",
      "./roles/hx_ca_trust_standardized/templates/health_report.j2",
      "./roles/hx_domain_join_standardized/templates/security_audit.j2",
      "./roles/hx_domain_join_standardized/templates/krb5.conf.j2",
      "./roles/hx_domain_join_standardized/templates/sudoers_domain.j2",
      "./roles/hx_domain_join_standardized/templates/resolv.conf.j2",
      "./roles/hx_domain_join_standardized/templates/realmd.conf.j2",
      "./roles/hx_domain_join_standardized/templates/sssd.conf.j2",
      "./roles/hx_domain_join_standardized/templates/health_report.j2",
      "./roles/ssh_key_management/templates/rotate_ssh_keys.sh.j2",
      "./roles/ssh_key_management/templates/ssh_config.j2",
      "./roles/ssh_key_management/templates/ssh_key_inventory.yml.j2",
      "./roles/operational_safety/templates/rollback_script.sh.j2",
      "./roles/hx_pg_auth_standardized/templates/security_audit.j2",
      "./roles/hx_pg_auth_standardized/templates/pg_ident.conf.j2",
      "./roles/hx_pg_auth_standardized/templates/postgresql.conf.j2",
      "./roles/hx_pg_auth_standardized/templates/backup_manifest.j2",
      "./roles/hx_pg_auth_standardized/templates/health_report.j2",
      "./roles/hx_pg_auth_standardized/templates/pg_hba.conf.j2",
      "./templates/safety_test_report.j2",
      "./templates/phase3_validation_report.json.j2"
    ]
  },
  "version": "1.0.0"
}