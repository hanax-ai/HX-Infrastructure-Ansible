---
# Ansible Lint Configuration for HX Infrastructure

# Exclude certain paths from linting
exclude_paths:
  - .cache/
  - .github/
  - .ansible/
  - vars/secrets.yml

# Use default rules with some customizations
use_default_rules: true

# Skip specific rules that may not apply to our infrastructure
skip_list:
  - yaml[line-length]  # Allow longer lines for readability in some cases
  - name[casing]       # Allow flexible naming conventions for roles

# Enable offline mode to avoid external dependencies during linting
offline: true

# Set the minimum required Ansible version
min_ansible_version: "2.12"

# Configure specific rule behaviors
rules:
  # Require explicit task names
  name[missing]: error
  
  # Enforce YAML formatting
  yaml[indentation]: error
  yaml[trailing-spaces]: error
  yaml[empty-lines]: error
  
  # Security-focused rules
  risky-file-permissions: error
  no-changed-when: warning
  command-instead-of-module: error
  
  # Best practices
  package-latest: warning
  deprecated-module: error

# Warn on files that are too complex
max_block_depth: 20

# Configure parseable output for CI/CD
parseable: false

# Enable colored output
colored: true

# Set verbosity level
verbosity: 1

# Profile to use (can be: min, basic, moderate, safety, shared, production)
profile: production

# Additional configuration for specific file types
kinds:
  - yaml: "**/*.yaml"
  - yaml: "**/*.yml"
  - playbook: "**/playbooks/*.yml"
  - playbook: "**/playbooks/**/*.yml"
  - tasks: "**/tasks/*.yml"
  - vars: "**/vars/*.yml"
  - defaults: "**/defaults/*.yml"
  - handlers: "**/handlers/*.yml"
  - meta: "**/meta/*.yml"
  - inventory: "**/inventory/**/*.yml"
  - requirements: "**/requirements.yml"

# Mock modules and roles for testing
mock_modules:
  - community.general.ufw
  - ansible.posix.firewalld

mock_roles:
  - geerlingguy.security
  - geerlingguy.firewall
  - geerlingguy.nginx
  - geerlingguy.ntp
