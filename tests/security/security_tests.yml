---
# Security Validation Tests
- name: Security Compliance Tests
  hosts: all
  gather_facts: true

  tasks:
    - name: Check SSH configuration
      lineinfile:
        path: /etc/ssh/sshd_config
        regexp: '^PasswordAuthentication'
        line: 'PasswordAuthentication no'
        state: present
      check_mode: true
      register: ssh_config

    - name: Verify firewall status
      command: ufw status
      register: firewall_status
      ignore_errors: true

    - name: Check for unauthorized users
      getent:
        database: passwd
      register: system_users
